(function(){"use strict";var t,e,n,r,o,i,u,s,c,f=[].slice;"undefined"!=typeof window&&null!==window?n=window.Words:"undefined"!=typeof module&&null!==module&&(n=require("words.js")),e=n.Strings,o=n.Types,i=function(t){var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0},u=function(t,e,n){var r,i;null==t&&(t={});for(r in e)i=e[r],o.isObject(i)&&u(t[r],i,n),n&&t.hasOwnProperty(r)||(t[r]=i);return t},s=function(t,e){var n,r,i;return e=o.forceFunction(e,function(){return!0}),i=function(t){var u,s,c,f;for(u in t)if(f=t[u],!o.notObject(t)){if(n.push(u),s=e(u,f,n)){if(o.isObject(s))if(s.remove===!0)delete t[u];else{if(o.isDefined(s.value)){f=t[u]=s.value;continue}o.isDefined(s.key)&&""!==(c=o.forceString(s.key))&&(t.hasOwnProperty(c)||(t[c]=f,delete t[u]))}if(r.push({key:u,value:f,path:n.join(" ")}),(null!=s?s.stop:void 0)===!0)return}i(f),n.pop()}},r=[],n=[],i(t),r},c=function(t,n,r){var i,u,s,c,f,p;if(s=e.oneSpaceAndTrim(o.forceString(n)).split(" "),""!==s[0]){if(u=s.length-2,u>-1){for(i=p=0;u>=0?u>=p:p>=u;i=u>=0?++p:--p)if(void 0===(t=t[s[i]]))return}else i=0;if(f=s[i],o.isDefined(r)&&t.hasOwnProperty(f)){if(r.remove)return delete t[f];r.key&&!t.hasOwnProperty(r.key)&&(t[r.key]=t[f],delete t[f],f=r.key),r.value&&t.hasOwnProperty(f)&&(t[f]=r.value)}return c=t[f]}},r=function(){function r(t,e){this.object={},t&&r.add(this.object,t,e)}return r.empty=function(t){return o.notObject(t)||t instanceof Number?!1:i(t)},r.extend=function(t,e){return u(o.forceObject(t),o.forceObject(e))},r.append=function(t,e){return u(o.forceObject(t),o.forceObject(e),!0)},r.add=function(t,e,r){var i,s,c,f,p,h,l;if(null==t&&(t={}),o.isObject(e))return u(t,e,!0);for(e=new n(e),f=o.isObject(r),c=t,l=e.words,i=p=0,h=l.length;h>p;i=++p)s=l[i],(i<e.count-1||f)&&null==c[s]&&(c[s]={}),i<e.count-1?c.hasOwnProperty(s)&&(c=c[s]):f?u(c[s],r,!0):null==c[s]&&(c[s]=r);return t},r.xs=function(t,e){return o.notObject(t)?[]:s(t,e)},r.copy=function(t){var e;return o.notObject(t)?{}:(e=function(t,n){var r,i;for(r in n)i=n[r],o.isObject(n)?t[r]=i:e(i);return t})({},t)},r.get=function(t,e,n){return o.isObject(t)?c(t,e,n):""},r.getn=function(t,e,n){return o.forceNumber(r.get(t,e),n)},r.gets=function(t,e){return o.forceString(r.get(t,e))},r.geta=function(t,e){return o.forceArray(r.get(t,e))},r.geto=function(t,e){return o.forceObject(r.get(t,e))},r.keys=function(t,e){var n,i;if(i=[],o.isObject(e=r.get(t,e)))for(n in e)i.push(n);return i},r.values=function(t,e){var n,i,u;if(u=[],o.isObject(e=r.get(t,e)))for(n in e)i=e[n],u.push(i);return u},r.prototype.xs=function(t){return r.xs(this.object,t)},r.prototype.empty=function(){return i(this.object)},r.prototype.copy=function(){return r.copy(this.object)},r.prototype.add=function(t,e){return r.add(this.object,t,e)},r.prototype.remove=function(t){return c(this.object,t,{remove:!0})},r.prototype.removeAll=function(t){return""!==(t=e.trim(t))&&r.xs(this.object,function(e){return e===t?{remove:!0}:void 0}),this},r.prototype.set=function(t,e){var n,i,u,s;if(""===(t=o.forceString(t)))return"";if(e=c(this.object,t,{value:e}),o.isObject(e))for(i=new r(e).search(),u=0,s=i.length;s>u;u++)n=i[u],this.triggerListener(t+" "+n.path,e);else this.triggerListener(t,e);return e},r.prototype.setAll=function(t,n){var o,i,u,s;if(""!==(t=e.trim(t)))for(r.xs(this.object,function(e){return e===t?{value:n}:void 0}),s=this.search(t),i=0,u=s.length;u>i;i++)o=s[i],this.triggerListener(o.path,n);return this},r.prototype.setKey=function(t,e){return c(this.object,t,{key:e})},r.prototype.setAllKeys=function(t,n){return""!==(t=e.trim(t))&&r.xs(this.object,function(e){return e===t?{key:n}:void 0}),this},r.prototype.search=function(t){var n,r;return o.isDefined(t)&&""===(t=e.trim(t))?[]:(n=t?function(e){return e===t?!0:void 0}:function(){return!0},r=this.xs(n))},r.prototype.list=function(t){var r;return""===(t=e.oneSpaceAndTrim(t))?[]:(r=t?function(e){return new n(e.join(" ")).startsWith(t)?!0:void 0}:function(){return!0},this.xs(function(t,e,n){return r(n)}))},r.prototype.get=function(t){return void 0===t?this.object:c(this.object,t)},r.prototype.getn=function(t,e){return r.getn(this.object,t,e)},r.prototype.gets=function(t){return r.gets(this.object,t)},r.prototype.geta=function(t){return r.geta(this.object,t)},r.prototype.geto=function(t){return r.geto(this.object,t)},r.prototype.keys=function(t){var e,n;if(n=[],o.isObject(t=c(this.object,t)))for(e in t)n.push(e);return n},r.prototype.values=function(t){var e,n,r;if(r=[],o.isObject(t=c(this.object,t)))for(e in t)n=t[e],r.push(n);return r},r.prototype.paths=function(t){var e,n,r,o,i;for(n=[],i=this.search(t),r=0,o=i.length;o>r;r++)e=i[r],n.push(e.path);return n},r.prototype.addListener=function(e,n){return this.listeners||(this.listeners=new t),this.listeners.add(e,n)},r.prototype.triggerListener=function(t,e){return this.listeners&&this.listeners.trigger(t,e),this},r.prototype.removeListener=function(){var t,e,n,r;if(e=1<=arguments.length?f.call(arguments,0):[],this.listeners)for(n=0,r=e.length;r>n;n++)t=e[n],this.listeners.remove(t);return this},r}(),t=function(){function t(t){this.listeners=null!=t?t:new r}return t.count=0,t.newName=function(){return""+ ++t.count},t.prototype.add=function(n,r){var o,i,u,s;return n=e.oneSpaceAndTrim(n),i=t.newName(),(o=this.listeners.get(n))?o[i]=r:(u={},u[i]=r,this.listeners.add(n,u)),s=this.listeners.get(n),{trigger:function(t){return null==t&&(t=""),"function"==typeof s[i]?s[i](n,t):void 0},remove:function(){return delete s[i]}}},t.prototype.trigger=function(t,r){var o,i,u,s,c,f,p,h,l,a;for(null==r&&(r=""),t=new n(t),c=this.listeners.search("*"),l=0,a=c.length;a>l;l++)if(p=c[l],i=p.value,h=new n(p.path).remove(-1).$,t.startsWith(h))for(f in i)o=i[f],"function"==typeof o&&o(t.$,r);c=this.listeners.get(e.oneSpaceAndTrim(t.$));for(u in c)s=c[u],"function"==typeof s&&s(t.$,r);return this},t.prototype.remove=function(t){return this.listeners.remove(e.oneSpaceAndTrim(t)),this},t}(),r.prototype.ls=r.prototype.list,r.prototype.find=r.prototype.search,r.Types=n.Types,r.Strings=n.Strings,r.Words=n,"undefined"!=typeof window&&null!==window?window.Xs=r:"undefined"!=typeof module&&null!==module&&(module.exports=r)}).call(this);